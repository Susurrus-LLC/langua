(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{HQiA:function(e,t,s){e.exports={section:"morph-module--section--1x2Hu",container:"morph-module--container--516fo",dataInput:"morph-module--data-input--GC2_A",textAreaSpacer:"morph-module--text-area-spacer--9X8FX",inputSection:"morph-module--input-section--5TGJN",outText:"morph-module--out-text--zsbge",different:"morph-module--different--2DmOi",changed:"morph-module--changed--8IbT4"}},OXyD:function(e,t,s){"use strict";var n=s("nKUr"),r=(s("q1tI"),s("soK+")),a=s.n(r);t.a=function(e){var t=e.children;return Object(n.jsx)("p",{className:a.a.notice,children:t})}},"f+hj":function(e,t,s){"use strict";s.r(t),s.d(t,"PureMorph",(function(){return k}));var n=s("nKUr"),r=s("q1tI"),a=s.n(r),i=s("Wbzz"),o=s("OXyD"),c=s("NYH8"),u=s("TSYQ"),l=s.n(u),h=s("wYtL"),p=s("FT44"),g=s("U8k4"),d=s("II/Z"),f=s("UvGF"),x=s("U29B"),m=s.n(x),b=function(e){var t=e.styles,s=e.data,r=e.change,i=e.morph,o=e.check,c=e.save,u=e.open,x=a.a.createRef(),b=function(e){return e.join("\n")};return Object(n.jsxs)(h.a,{name:"morph-form",children:[Object(n.jsxs)("div",{className:t.section,children:[Object(n.jsxs)("div",{className:l()(t.categories,t.inputSection,m.a.part),children:[Object(n.jsx)("h5",{className:m.a.sectionTitle,children:"Categories"}),Object(n.jsxs)("div",{className:t.container,children:[Object(n.jsx)("textarea",{id:"categories",name:"categories",className:l()(t.categoriesInput,t.dataInput),value:b(s.categories),onChange:r,"aria-label":"Categories"}),Object(n.jsxs)("div",{className:t.textAreaSpacer,children:[b(s.categories)," "]})]})]}),Object(n.jsxs)("div",{className:l()(t.rewriteRules,t.inputSection,m.a.part),children:[Object(n.jsx)("h5",{className:m.a.sectionTitle,children:"Rewrite Rules"}),Object(n.jsxs)("div",{className:t.container,children:[Object(n.jsx)("textarea",{id:"rewriteRules",name:"rewriteRules",className:l()(t.rewriteRulesInput,t.dataInput),value:b(s.rewriteRules),onChange:r,"aria-label":"Rewrite rules"}),Object(n.jsxs)("div",{className:t.textAreaSpacer,children:[b(s.rewriteRules)," "]})]})]}),Object(n.jsxs)("div",{className:l()(t.soundChanges,t.inputSection,m.a.part),children:[Object(n.jsx)("h5",{className:m.a.sectionTitle,children:"Sound Changes"}),Object(n.jsxs)("div",{className:t.container,children:[Object(n.jsx)("textarea",{id:"soundChanges",name:"soundChanges",className:l()(t.soundChangesInput,t.dataInput),value:b(s.soundChanges),onChange:r,"aria-label":"Sound changes"}),Object(n.jsxs)("div",{className:t.textAreaSpacer,children:[b(s.soundChanges)," "]})]})]}),Object(n.jsxs)("div",{className:l()(t.lexicon,t.inputSection,m.a.part),children:[Object(n.jsx)("h5",{className:m.a.sectionTitle,children:"Lexicon"}),Object(n.jsxs)("div",{className:t.container,children:[Object(n.jsx)("textarea",{id:"lexicon",name:"lexicon",className:l()(t.lexiconInput,t.dataInput),value:b(s.lexicon),onChange:r,"aria-label":"Lexicon"}),Object(n.jsxs)("div",{className:t.textAreaSpacer,children:[b(s.lexicon)," "]})]})]})]}),Object(n.jsxs)(g.a,{addedClasses:m.a.part,children:[Object(n.jsxs)(d.a,{side:"left",children:[Object(n.jsx)(f.a,{children:Object(n.jsx)(p.a,{type:"submit",ver:"neutral",onClick:i,children:"Change"})}),Object(n.jsxs)(f.a,{children:[Object(n.jsx)("label",{htmlFor:"outputFormat",children:"output format:"}),Object(n.jsxs)("select",{id:"outputFormat",name:"outputFormat",value:s.outputFormat,onChange:r,children:[Object(n.jsx)("option",{value:"oo",children:"output"}),Object(n.jsx)("option",{value:"io",children:"input → output"}),Object(n.jsx)("option",{value:"oi",children:"output ← input"})]})]}),Object(n.jsx)(f.a,{children:Object(n.jsxs)("div",{children:[Object(n.jsxs)("label",{children:[Object(n.jsx)("input",{type:"checkbox",id:"showChanges",name:"options",value:"showChanges",checked:s.showChanges,onChange:o})," ","italicize changes"]}),Object(n.jsx)("br",{}),Object(n.jsxs)("label",{children:[Object(n.jsx)("input",{type:"checkbox",id:"showDiff",name:"options",value:"showDiff",checked:s.showDiff,onChange:o})," ","bold differences"]})]})}),Object(n.jsx)(f.a,{children:Object(n.jsxs)("div",{children:[Object(n.jsxs)("label",{children:[Object(n.jsx)("input",{type:"checkbox",id:"ruleReport",name:"options",value:"ruleReport",checked:s.ruleReport,onChange:o})," ","report applied rules"]}),Object(n.jsx)("br",{}),Object(n.jsxs)("label",{children:[Object(n.jsx)("input",{type:"checkbox",id:"rewriteOutput",name:"options",value:"rewriteOutput",checked:s.rewriteOutput,onChange:o})," ","rewrite on output"]})]})})]}),Object(n.jsxs)(d.a,{side:"right",children:[Object(n.jsx)(f.a,{children:Object(n.jsx)(p.a,{id:"save",ver:"success",onClick:c,type:"button",children:"Save"})}),Object(n.jsxs)(f.a,{children:[Object(n.jsx)(p.a,{id:"open",onClick:function(e){e.preventDefault(),x.current.value="",x.current.click()},type:"button",children:"Open"}),Object(n.jsx)("input",{id:"file",name:"file",className:m.a.hidden,type:"file",ref:x,onChange:u})]})]})]})]})},j=s("49EY"),v=s("X3Hw"),w=s.n(v),O=function(e){var t,s=e.styles,r=e.outputFormat,a=e.results,i=e.showDiff,o=e.showChanges,c=a||[];return Object(n.jsxs)(j.a,{children:[Object(n.jsx)("div",{className:s.output,children:function(){if("string"==typeof c[0])return c.map((function(e,t){return Object(n.jsx)("p",{className:l()(s.outText,w.a.error),children:e},t)}));var e=function(e){return"oo"===r?e.output.trim():"io"===r?e.input.trim()+" "+String.fromCharCode(8594)+" "+e.output.trim():"oi"===r?e.output.trim()+" "+String.fromCharCode(8592)+" "+e.input.trim():void 0},t=function(e){return i&&e.diff?o&&e.input!==e.output?l()(s.outText,s.different,s.changed):l()(s.outText,s.different):o&&e.input!==e.output?l()(s.outText,s.changed):s.outText};return c.length>0?c.map((function(s,r){return Object(n.jsx)("p",{className:t(s),children:e(s)},r)})):Object(n.jsx)("p",{className:s.outText})}()}),Object(n.jsx)("div",{className:w.a.stats,children:Object(n.jsx)("p",{className:w.a.statsText,children:(t=function(){for(var e=c.length,t=0,s=0,n=0;n<e;n++)c[n].input===c[n].output&&t++,c[n].diff&&s++;return{total:e,changed:e-t,unchangedWords:t,different:s,same:e-s}}(),t.changed+" of "+t.total+" words changed ("+t.unchanged+" unchanged); "+t.different+" of "+t.total+" words different from last time ("+t.same+" the same)")})})]})},C=s("FGyW"),y=s("NT95"),N=s.n(y),R=s("SMIz"),S=s("C713"),D=new(function(){function e(){this.item="morph",this.getData=this.getData.bind(this),this.removeResults=this.removeResults.bind(this),this.setStorage=this.setStorage.bind(this),this.save=this.save.bind(this),this.open=this.open.bind(this),this.splitRewriteRules=this.splitRewriteRules.bind(this),this.rewriteCats=this.rewriteCats.bind(this),this.splitCategories=this.splitCategories.bind(this),this.rewriteChanges=this.rewriteChanges.bind(this),this.splitSoundChanges=this.splitSoundChanges.bind(this),this.rewriteLex=this.rewriteLex.bind(this),this.unrewriteLex=this.unrewriteLex.bind(this),this.applyChanges=this.applyChanges.bind(this),this.getResults=this.getResults.bind(this),this.idDiff=this.idDiff.bind(this),this.morph=this.morph.bind(this)}var t=e.prototype;return t.getData=function(){return R.a.getData(this.item)},t.removeResults=function(e){var t=JSON.parse(JSON.stringify(e));return delete t.results,t},t.setStorage=function(e){R.a.setStorage(this.removeResults(e),this.item)},t.save=function(e){S.a.save(this.removeResults(e),this.item)},t.open=function(e,t){var s,n=this;window.FileReader?S.a.openFile(e,(function(r){if(e.name.endsWith(".lngm")){var a=N()({categories:Array.of(String),rewriteRules:Array.of(String),soundChanges:Array.of(String),lexicon:Array.of(String),outputFormat:["oo","io","oi"],showDiff:Boolean,ruleReport:Boolean,rewriteOutput:Boolean}),i=JSON.parse(r);i.results&&(i.results.words=+i.results.words),a(i)?(C.c.success("Data loaded from "+e.name+".",{autoClose:5e3,className:"toast-opened",bodyClassName:"toast-opened-body",progressClassName:"toast-opened-progress"}),n.setStorage(i),s=i):(C.c.warn("The content of "+e.name+" is invalid.",{autoClose:5e3,className:"toast-unopened",bodyClassName:"toast-unopened-body",progressClassName:"toast-unopened-progress"}),console.error(a.errors(i)),s=!1)}else C.c.warn("Wrong filetype selected.",{autoClose:5e3,className:"toast-unopened",bodyClassName:"toast-unopened-body",progressClassName:"toast-unopened-progress"}),s=!1;t(s)})):(C.c.warn("Your browser is unable to open files.",{autoClose:5e3,className:"toast-unopened",bodyClassName:"toast-unopened-body",progressClassName:"toast-unopened-progress"}),t(s=!1))},t.splitRewriteRules=function(e){for(var t=[],s=[],n=0;n<e.length;n++){var r=e[n].split("=");if(r.length>2)s.push("The rewrite rule "+e[n]+" has too many = signs.");else if(r.length<2){if(0===e[n].length)continue;s.push("The rewrite rule "+e[n]+" is missing an = sign.")}else t.push({rewriteFrom:r[0],rewriteTo:r[1]})}return s.length?s:t},t.rewriteCats=function(e,t){for(var s=0;s<t.length;s++){var n=new RegExp(t[s].rewriteFrom,"g");e[1]=e[1].replace(n,t[s].rewriteTo)}return e},t.splitCategories=function(e,t){for(var s=[],n=[],r=0;r<e.length;r++){var a=e[r].split("=");if(a.length>2)n.push("The category "+e[r]+" has too many = signs.");else if(a.length<2){if(0===e[r].length)continue;n.push("The category "+e[r]+" is missing an = sign.")}else if(a[0].length>1)n.push("The category "+e[r]+" needs to be assigned to a single-character variable.");else{var i=this.rewriteCats(a,t);s.push(i)}}for(var o=[],c=0;c<s.length;c++){var u={};u.variable=s[c][0],u.categories=s[c][1].split(""),o.push(u)}return n.length?n:o},t.rewriteChanges=function(e,t){var s=JSON.parse(JSON.stringify(e));for(var n in s)if(s.hasOwnProperty(n))for(var r=0;r<t.length;r++){var a=new RegExp(t[r].rewriteFrom,"g");s[n]=s[n].replace(a,t[r].rewriteTo)}return s},t.splitSoundChanges=function(e,t,s){for(var n=[],r=[],a=function(t){var s=!1;switch(t){case"_":return"target";case"#":return"wordboundary";case"[":return"brackopen";case"]":return"brackclose";case"(":return"parenopen";case")":return"parenclose";default:for(var n=0;n<e.length;n++)if(t===e[n].variable){s=!0;break}return s?"category":"literal"}},i=0;i<t.length;i++){var o=t[i].split("/");if(o.length>4)r.push("The sound change "+t[i]+" has too many / signs.");else if(o.length<2){if(0===t[i].length)continue;r.push("The sound change "+t[i]+" is missing a / sign.")}else{var c={changeFrom:o[0],changeTo:o[1]};o[2]&&(c.context=o[2],/_/.test(o[2])?/_/.exec(o[2]).length>2&&r.push("The context in the sound change "+t[i]+" has too many _ signs."):r.push("The context in the sound change "+t[i]+" is missing an _ sign.")),o[3]&&(c.exception=o[3],/_/.test(o[3])?/_/.exec(o[3]).length>2&&r.push("The exception in the sound change "+t[i]+" has too many _ signs."):r.push("The exception in the sound change "+t[i]+" is missing an _ sign."));for(var u=this.rewriteChanges(c,s),l=[],h=0;h<u.changeFrom.length;h++)l.push(a(u.changeFrom[h]));u.changeFromID=l;for(var p=[],g=0;g<u.changeTo.length;g++)p.push(a(u.changeTo[g]));u.changeToID=p;var d=[];if(u.context){for(var f=0;f<u.context.length;f++)d.push(a(u.context[f]));u.contextID=d}var x=[];if(u.exception){for(var m=0;m<u.exception.length;m++)x.push(a(u.exception[m]));u.exceptionID=x}n.push(u)}}return r.length?r:n},t.rewriteLex=function(e,t){for(var s=[],n=0;n<e.length;n++){for(var r=e[n],a=0;a<t.length;a++){var i=new RegExp(t[a].rewriteFrom,"g");r=r.replace(i,t[a].rewriteTo)}s.push(r)}return s},t.unrewriteLex=function(e,t){for(var s=JSON.parse(JSON.stringify(e)),n=0;n<s.length;n++)for(var r=0;r<t.length;r++){var a=new RegExp(t[r].rewriteTo,"g");s[n].output=s[n].output.replace(a,t[r].rewriteFrom)}return s},t.applyChanges=function(e,t,s){for(var n=s,r=0;r<t.length;r++){t[r].context&&t[r].context.replace(/#/g,"\\b"),t[r].exception&&t[r].exception.replace(/#/g,"\\b");var a=void 0,i=void 0,o=void 0,c=void 0;t[r].context?(a=t[r].context.replace("_",t[r].changeFrom),i=t[r].context.replace("_",t[r].changeTo),t[r].exception?(o=t[r].exception.replace("_",t[r].changeFrom),c=new RegExp(o+"|("+a+")","g"),n=n.replace(c,i)):(c=new RegExp(a,"g"),n=n.replace(c,i))):(c=new RegExp(t[r].changeFrom,"g"),n=n.replace(c,t[r].changeTo))}return n},t.getResults=function(e,t,s,n,r){for(var a=this.rewriteLex(n,t),i=[],o=0;o<n.length;o++)i.push({input:n[o],output:this.applyChanges(e,s,a[o])});return r?this.unrewriteLex(i,t):i},t.idDiff=function(e,t){var s=JSON.parse(JSON.stringify(t));if(void 0!==e.results&&e.results.length&&"string"!=typeof e.results[0])for(var n=0;n<s.length;n++)s[n].diff=s[n].input!==e.results[n].input||s[n].output!==e.results[n].output;else for(var r=0;r<s.length;r++)s[r].diff=!0;return s},t.morph=function(e){var t=JSON.parse(JSON.stringify(e)),s=this.splitRewriteRules(t.rewriteRules),n=this.splitCategories(t.categories,s),r=this.splitSoundChanges(n,t.soundChanges,s),a=[];if("string"==typeof n[0]&&(a=a.concat(n)),"string"==typeof s[0]&&(a=a.concat(s)),"string"==typeof r[0]&&(a=a.concat(r)),a.length)return a;var i=this.getResults(n,s,r,t.lexicon,t.rewriteOutput);return this.idDiff(t,i)},e}()),T=s("HQiA"),F=s.n(T),k=function(e){var t,s,a,i=e.data,u=null==i||null===(t=i.site)||void 0===t||null===(s=t.siteMetadata)||void 0===s||null===(a=s.toolInfo)||void 0===a?void 0:a.morph,l=Object(r.useState)(D.getData().categories),h=l[0],p=l[1],g=Object(r.useState)(D.getData().rewriteRules),d=g[0],f=g[1],x=Object(r.useState)(D.getData().soundChanges),m=x[0],j=x[1],v=Object(r.useState)(D.getData().lexicon),w=v[0],C=v[1],y=Object(r.useState)(D.getData().outputFormat),N=y[0],R=y[1],S=Object(r.useState)(D.getData().showDiff),T=S[0],k=S[1],I=Object(r.useState)(D.getData().showChanges),J=I[0],_=I[1],A=Object(r.useState)(D.getData().ruleReport),L=A[0],E=A[1],z=Object(r.useState)(D.getData().rewriteOutput),H=z[0],U=z[1],W=Object(r.useState)(D.getData().results),X=W[0],Y=W[1];return Object(n.jsxs)(c.a,{toolInfo:u,children:[Object(n.jsx)(o.a,{children:"This tool is still in development."}),Object(n.jsx)(b,{styles:F.a,data:{categories:h,rewriteRules:d,soundChanges:m,lexicon:w,outputFormat:N,showDiff:T,showChanges:J,ruleReport:L,rewriteOutput:H},change:function(e){var t,s=e.target.name;switch(t="textarea"===e.target.type?e.target.value.split("\n"):e.target.value,s){case"categories":p(t);break;case"rewriteRules":f(t);break;case"soundChanges":j(t);break;case"lexicon":C(t);break;case"outputFormat":R(t)}},morph:function(e){e.preventDefault();var t={categories:h,rewriteRules:d,soundChanges:m,lexicon:w,outputFormat:N,showDiff:T,showChanges:J,ruleReport:L,rewriteOutput:H,results:X};Y(D.morph(t)),D.setStorage(t)},check:function(e){var t=e.target.value,s=e.target.checked;switch(t){case"showChanges":_(s);break;case"showDiff":k(s);break;case"ruleReport":E(s);break;case"rewriteOutput":U(s)}},save:function(e){e.preventDefault();var t={categories:h,rewriteRules:d,soundChanges:m,lexicon:w,outputFormat:N,showDiff:T,showChanges:J,ruleReport:L,rewriteOutput:H,results:X};D.save(t)},open:function(e){e.preventDefault();var t=e.target.files[0];D.open(t,(function(e){e&&(p(e.categories),f(e.rewriteRules),j(e.soundChanges),C(e.lexicon),R(e.outputFormat),k(e.showDiff),_(e.showChanges),E(e.ruleReport),U(e.rewriteOutput),Y(e.results))}))}}),Object(n.jsx)(O,{styles:F.a,outputFormat:N,results:X,showDiff:T,showChanges:J})]})};t.default=function(e){var t=Object(i.useStaticQuery)("110386547");return Object(n.jsx)(k,Object.assign({},e,{data:t}))}},"soK+":function(e,t,s){e.exports={notice:"notice-module--notice--14xfk"}}}]);
//# sourceMappingURL=component---src-pages-morph-index-js-316fc176bd3c165b3e61.js.map