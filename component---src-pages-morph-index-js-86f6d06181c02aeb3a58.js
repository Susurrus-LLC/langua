(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{HQiA:function(e,t,a){e.exports={section:"morph-module--section--1x2Hu",container:"morph-module--container--516fo",dataInput:"morph-module--data-input--GC2_A",textAreaSpacer:"morph-module--text-area-spacer--9X8FX",inputSection:"morph-module--input-section--5TGJN",outText:"morph-module--out-text--zsbge",different:"morph-module--different--2DmOi",changed:"morph-module--changed--8IbT4"}},OXyD:function(e,t,a){"use strict";var n=a("q1tI"),r=a.n(n),s=a("soK+"),o=a.n(s);t.a=function(e){var t=e.children;return r.a.createElement("p",{className:o.a.notice},t)}},"f+hj":function(e,t,a){"use strict";a.r(t),a.d(t,"PureMorph",(function(){return F}));var n=a("q1tI"),r=a.n(n),s=a("Wbzz"),o=a("OXyD"),i=a("NYH8"),l=a("TSYQ"),u=a.n(l),c=a("wYtL"),h=a("FT44"),p=a("U8k4"),g=a("II/Z"),m=a("UvGF"),d=a("U29B"),f=a.n(d),v=function(e){var t=e.styles,a=e.data,n=e.change,s=e.morph,o=e.check,i=e.save,l=e.open,d=r.a.createRef(),v=function(e){return e.join("\n")};return r.a.createElement(c.a,{name:"morph-form"},r.a.createElement("div",{className:t.section},r.a.createElement("div",{className:u()(t.categories,t.inputSection,f.a.part)},r.a.createElement("h5",{className:f.a.sectionTitle},"Categories"),r.a.createElement("div",{className:t.container},r.a.createElement("textarea",{id:"categories",name:"categories",className:u()(t.categoriesInput,t.dataInput),value:v(a.categories),onChange:n,"aria-label":"Categories"}),r.a.createElement("div",{className:t.textAreaSpacer},v(a.categories)," "))),r.a.createElement("div",{className:u()(t.rewriteRules,t.inputSection,f.a.part)},r.a.createElement("h5",{className:f.a.sectionTitle},"Rewrite Rules"),r.a.createElement("div",{className:t.container},r.a.createElement("textarea",{id:"rewriteRules",name:"rewriteRules",className:u()(t.rewriteRulesInput,t.dataInput),value:v(a.rewriteRules),onChange:n,"aria-label":"Rewrite rules"}),r.a.createElement("div",{className:t.textAreaSpacer},v(a.rewriteRules)," "))),r.a.createElement("div",{className:u()(t.soundChanges,t.inputSection,f.a.part)},r.a.createElement("h5",{className:f.a.sectionTitle},"Sound Changes"),r.a.createElement("div",{className:t.container},r.a.createElement("textarea",{id:"soundChanges",name:"soundChanges",className:u()(t.soundChangesInput,t.dataInput),value:v(a.soundChanges),onChange:n,"aria-label":"Sound changes"}),r.a.createElement("div",{className:t.textAreaSpacer},v(a.soundChanges)," "))),r.a.createElement("div",{className:u()(t.lexicon,t.inputSection,f.a.part)},r.a.createElement("h5",{className:f.a.sectionTitle},"Lexicon"),r.a.createElement("div",{className:t.container},r.a.createElement("textarea",{id:"lexicon",name:"lexicon",className:u()(t.lexiconInput,t.dataInput),value:v(a.lexicon),onChange:n,"aria-label":"Lexicon"}),r.a.createElement("div",{className:t.textAreaSpacer},v(a.lexicon)," ")))),r.a.createElement(p.a,{addedClasses:f.a.part},r.a.createElement(g.a,{side:"left"},r.a.createElement(m.a,null,r.a.createElement(h.a,{type:"submit",ver:"neutral",onClick:s},"Change")),r.a.createElement(m.a,null,r.a.createElement("label",{htmlFor:"outputFormat"},"output format:"),r.a.createElement("select",{id:"outputFormat",name:"outputFormat",value:a.outputFormat,onChange:n},r.a.createElement("option",{value:"oo"},"output"),r.a.createElement("option",{value:"io"},"input → output"),r.a.createElement("option",{value:"oi"},"output ← input"))),r.a.createElement(m.a,null,r.a.createElement("div",null,r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",id:"showChanges",name:"options",value:"showChanges",checked:a.showChanges,onChange:o})," ","italicize changes"),r.a.createElement("br",null),r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",id:"showDiff",name:"options",value:"showDiff",checked:a.showDiff,onChange:o})," ","bold differences"))),r.a.createElement(m.a,null,r.a.createElement("div",null,r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",id:"ruleReport",name:"options",value:"ruleReport",checked:a.ruleReport,onChange:o})," ","report applied rules"),r.a.createElement("br",null),r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",id:"rewriteOutput",name:"options",value:"rewriteOutput",checked:a.rewriteOutput,onChange:o})," ","rewrite on output")))),r.a.createElement(g.a,{side:"right"},r.a.createElement(m.a,null,r.a.createElement(h.a,{id:"save",ver:"success",onClick:i,type:"button"},"Save")),r.a.createElement(m.a,null,r.a.createElement(h.a,{id:"open",onClick:function(e){e.preventDefault(),d.current.value="",d.current.click()},type:"button"},"Open"),r.a.createElement("input",{id:"file",name:"file",className:f.a.hidden,type:"file",ref:d,onChange:l})))))},w=a("49EY"),x=a("X3Hw"),C=a.n(x),b=function(e){var t,a=e.styles,n=e.outputFormat,s=e.results,o=e.showDiff,i=e.showChanges,l=s||[];return r.a.createElement(w.a,null,r.a.createElement("div",{className:a.output},function(){if("string"==typeof l[0])return l.map((function(e,t){return r.a.createElement("p",{className:u()(a.outText,C.a.error),key:t},e)}));var e=function(e){return o&&e.diff?i&&e.input!==e.output?u()(a.outText,a.different,a.changed):u()(a.outText,a.different):i&&e.input!==e.output?u()(a.outText,a.changed):a.outText};return l.length>0?l.map((function(t,a){return r.a.createElement("p",{className:e(t),key:a},function(e){return"oo"===n?e.output.trim():"io"===n?e.input.trim()+" "+String.fromCharCode(8594)+" "+e.output.trim():"oi"===n?e.output.trim()+" "+String.fromCharCode(8592)+" "+e.input.trim():void 0}(t))})):r.a.createElement("p",{className:a.outText})}()),r.a.createElement("div",{className:C.a.stats},r.a.createElement("p",{className:C.a.statsText},(t=function(){for(var e=l.length,t=0,a=0,n=0;n<e;n++)l[n].input===l[n].output&&t++,l[n].diff&&a++;return{total:e,changed:e-t,unchangedWords:t,different:a,same:e-a}}()).changed+" of "+t.total+" words changed ("+t.unchanged+" unchanged); "+t.different+" of "+t.total+" words different from last time ("+t.same+" the same)")))},E=a("FGyW"),y=a("NT95"),N=a.n(y),R=a("SMIz"),S=a("C713"),D=new(function(){function e(){this.item="morph",this.getData=this.getData.bind(this),this.removeResults=this.removeResults.bind(this),this.setStorage=this.setStorage.bind(this),this.save=this.save.bind(this),this.open=this.open.bind(this),this.splitRewriteRules=this.splitRewriteRules.bind(this),this.rewriteCats=this.rewriteCats.bind(this),this.splitCategories=this.splitCategories.bind(this),this.rewriteChanges=this.rewriteChanges.bind(this),this.splitSoundChanges=this.splitSoundChanges.bind(this),this.rewriteLex=this.rewriteLex.bind(this),this.unrewriteLex=this.unrewriteLex.bind(this),this.applyChanges=this.applyChanges.bind(this),this.getResults=this.getResults.bind(this),this.idDiff=this.idDiff.bind(this),this.morph=this.morph.bind(this)}var t=e.prototype;return t.getData=function(){return R.a.getData(this.item)},t.removeResults=function(e){var t=JSON.parse(JSON.stringify(e));return delete t.results,t},t.setStorage=function(e){R.a.setStorage(this.removeResults(e),this.item)},t.save=function(e){S.a.save(this.removeResults(e),this.item)},t.open=function(e,t){var a,n=this;window.FileReader?S.a.openFile(e,(function(r){if(e.name.endsWith(".lngm")){var s=N()({categories:Array.of(String),rewriteRules:Array.of(String),soundChanges:Array.of(String),lexicon:Array.of(String),outputFormat:["oo","io","oi"],showDiff:Boolean,ruleReport:Boolean,rewriteOutput:Boolean}),o=JSON.parse(r);o.results&&(o.results.words=+o.results.words),s(o)?(E.c.success("Data loaded from "+e.name+".",{autoClose:5e3,className:"toast-opened",bodyClassName:"toast-opened-body",progressClassName:"toast-opened-progress"}),n.setStorage(o),a=o):(E.c.info("The content of "+e.name+" is invalid.",{autoClose:5e3,className:"toast-unopened",bodyClassName:"toast-unopened-body",progressClassName:"toast-unopened-progress"}),console.error(s.errors(o)),a=!1)}else E.c.info("Wrong filetype selected.",{autoClose:5e3,className:"toast-unopened",bodyClassName:"toast-unopened-body",progressClassName:"toast-unopened-progress"}),a=!1;t(a)})):(E.c.info("Your browser is unable to open files.",{autoClose:5e3,className:"toast-unopened",bodyClassName:"toast-unopened-body",progressClassName:"toast-unopened-progress"}),t(a=!1))},t.splitRewriteRules=function(e){for(var t=[],a=[],n=0;n<e.length;n++){var r=e[n].split("=");if(r.length>2)a.push("The rewrite rule "+e[n]+" has too many = signs.");else if(r.length<2){if(0===e[n].length)continue;a.push("The rewrite rule "+e[n]+" is missing an = sign.")}else t.push({rewriteFrom:r[0],rewriteTo:r[1]})}return a.length?a:t},t.rewriteCats=function(e,t){for(var a=0;a<t.length;a++){var n=new RegExp(t[a].rewriteFrom,"g");e[1]=e[1].replace(n,t[a].rewriteTo)}return e},t.splitCategories=function(e,t){for(var a=[],n=[],r=0;r<e.length;r++){var s=e[r].split("=");if(s.length>2)n.push("The category "+e[r]+" has too many = signs.");else if(s.length<2){if(0===e[r].length)continue;n.push("The category "+e[r]+" is missing an = sign.")}else if(s[0].length>1)n.push("The category "+e[r]+" needs to be assigned to a single-character variable.");else{var o=this.rewriteCats(s,t);a.push(o)}}for(var i=[],l=0;l<a.length;l++){var u={};u.variable=a[l][0],u.categories=a[l][1].split(""),i.push(u)}return n.length?n:i},t.rewriteChanges=function(e,t){var a=JSON.parse(JSON.stringify(e));for(var n in a)if(a.hasOwnProperty(n))for(var r=0;r<t.length;r++){var s=new RegExp(t[r].rewriteFrom,"g");a[n]=a[n].replace(s,t[r].rewriteTo)}return a},t.splitSoundChanges=function(e,t,a){for(var n=[],r=[],s=function(t){var a=!1;switch(t){case"_":return"target";case"#":return"wordboundary";case"[":return"brackopen";case"]":return"brackclose";case"(":return"parenopen";case")":return"parenclose";default:for(var n=0;n<e.length;n++)if(t===e[n].variable){a=!0;break}return a?"category":"literal"}},o=0;o<t.length;o++){var i=t[o].split("/");if(i.length>4)r.push("The sound change "+t[o]+" has too many / signs.");else if(i.length<2){if(0===t[o].length)continue;r.push("The sound change "+t[o]+" is missing a / sign.")}else{var l={changeFrom:i[0],changeTo:i[1]};i[2]&&(l.context=i[2],/_/.test(i[2])?/_/.exec(i[2]).length>2&&r.push("The context in the sound change "+t[o]+" has too many _ signs."):r.push("The context in the sound change "+t[o]+" is missing an _ sign.")),i[3]&&(l.exception=i[3],/_/.test(i[3])?/_/.exec(i[3]).length>2&&r.push("The exception in the sound change "+t[o]+" has too many _ signs."):r.push("The exception in the sound change "+t[o]+" is missing an _ sign."));for(var u=this.rewriteChanges(l,a),c=[],h=0;h<u.changeFrom.length;h++)c.push(s(u.changeFrom[h]));u.changeFromID=c;for(var p=[],g=0;g<u.changeTo.length;g++)p.push(s(u.changeTo[g]));u.changeToID=p;var m=[];if(u.context){for(var d=0;d<u.context.length;d++)m.push(s(u.context[d]));u.contextID=m}var f=[];if(u.exception){for(var v=0;v<u.exception.length;v++)f.push(s(u.exception[v]));u.exceptionID=f}n.push(u)}}return r.length?r:n},t.rewriteLex=function(e,t){for(var a=[],n=0;n<e.length;n++){for(var r=e[n],s=0;s<t.length;s++){var o=new RegExp(t[s].rewriteFrom,"g");r=r.replace(o,t[s].rewriteTo)}a.push(r)}return a},t.unrewriteLex=function(e,t){for(var a=JSON.parse(JSON.stringify(e)),n=0;n<a.length;n++)for(var r=0;r<t.length;r++){var s=new RegExp(t[r].rewriteTo,"g");a[n].output=a[n].output.replace(s,t[r].rewriteFrom)}return a},t.applyChanges=function(e,t,a){for(var n=a,r=0;r<t.length;r++){t[r].context&&t[r].context.replace(/#/g,"\\b"),t[r].exception&&t[r].exception.replace(/#/g,"\\b");var s=void 0,o=void 0,i=void 0,l=void 0;t[r].context?(s=t[r].context.replace("_",t[r].changeFrom),o=t[r].context.replace("_",t[r].changeTo),t[r].exception?(i=t[r].exception.replace("_",t[r].changeFrom),l=new RegExp(i+"|("+s+")","g"),n=n.replace(l,o)):(l=new RegExp(s,"g"),n=n.replace(l,o))):(l=new RegExp(t[r].changeFrom,"g"),n=n.replace(l,t[r].changeTo))}return n},t.getResults=function(e,t,a,n,r){for(var s=this.rewriteLex(n,t),o=[],i=0;i<n.length;i++)o.push({input:n[i],output:this.applyChanges(e,a,s[i])});return r?this.unrewriteLex(o,t):o},t.idDiff=function(e,t){var a=JSON.parse(JSON.stringify(t));if(void 0!==e.results&&e.results.length&&"string"!=typeof e.results[0])for(var n=0;n<a.length;n++)a[n].diff=a[n].input!==e.results[n].input||a[n].output!==e.results[n].output;else for(var r=0;r<a.length;r++)a[r].diff=!0;return a},t.morph=function(e){var t=JSON.parse(JSON.stringify(e)),a=this.splitRewriteRules(t.rewriteRules),n=this.splitCategories(t.categories,a),r=this.splitSoundChanges(n,t.soundChanges,a),s=[];if("string"==typeof n[0]&&(s=s.concat(n)),"string"==typeof a[0]&&(s=s.concat(a)),"string"==typeof r[0]&&(s=s.concat(r)),s.length)return s;var o=this.getResults(n,a,r,t.lexicon,t.rewriteOutput);return this.idDiff(t,o)},e}()),T=a("HQiA"),O=a.n(T),F=function(e){var t,a,s,l=e.data,u=null==l||null===(t=l.site)||void 0===t||null===(a=t.siteMetadata)||void 0===a||null===(s=a.toolInfo)||void 0===s?void 0:s.morph,c=Object(n.useState)(D.getData().categories),h=c[0],p=c[1],g=Object(n.useState)(D.getData().rewriteRules),m=g[0],d=g[1],f=Object(n.useState)(D.getData().soundChanges),w=f[0],x=f[1],C=Object(n.useState)(D.getData().lexicon),E=C[0],y=C[1],N=Object(n.useState)(D.getData().outputFormat),R=N[0],S=N[1],T=Object(n.useState)(D.getData().showDiff),F=T[0],k=T[1],I=Object(n.useState)(D.getData().showChanges),j=I[0],J=I[1],_=Object(n.useState)(D.getData().ruleReport),A=_[0],L=_[1],z=Object(n.useState)(D.getData().rewriteOutput),H=z[0],W=z[1],X=Object(n.useState)(D.getData().results),Y=X[0],B=X[1];return r.a.createElement(i.a,{toolInfo:u},r.a.createElement(o.a,null,"This tool is still in development."),r.a.createElement(v,{styles:O.a,data:{categories:h,rewriteRules:m,soundChanges:w,lexicon:E,outputFormat:R,showDiff:F,showChanges:j,ruleReport:A,rewriteOutput:H},change:function(e){var t,a=e.target.name;switch(t="textarea"===e.target.type?e.target.value.split("\n"):e.target.value,a){case"categories":p(t);break;case"rewriteRules":d(t);break;case"soundChanges":x(t);break;case"lexicon":y(t);break;case"outputFormat":S(t)}},morph:function(e){e.preventDefault();var t={categories:h,rewriteRules:m,soundChanges:w,lexicon:E,outputFormat:R,showDiff:F,showChanges:j,ruleReport:A,rewriteOutput:H,results:Y};B(D.morph(t)),D.setStorage(t)},check:function(e){var t=e.target.value,a=e.target.checked;switch(t){case"showChanges":J(a);break;case"showDiff":k(a);break;case"ruleReport":L(a);break;case"rewriteOutput":W(a)}},save:function(e){e.preventDefault();var t={categories:h,rewriteRules:m,soundChanges:w,lexicon:E,outputFormat:R,showDiff:F,showChanges:j,ruleReport:A,rewriteOutput:H,results:Y};D.save(t)},open:function(e){e.preventDefault();var t=e.target.files[0];D.open(t,(function(e){e&&(p(e.categories),d(e.rewriteRules),x(e.soundChanges),y(e.lexicon),S(e.outputFormat),k(e.showDiff),J(e.showChanges),L(e.ruleReport),W(e.rewriteOutput),B(e.results))}))}}),r.a.createElement(b,{styles:O.a,outputFormat:R,results:Y,showDiff:F,showChanges:j}))};t.default=function(e){var t=Object(s.useStaticQuery)("110386547");return r.a.createElement(F,Object.assign({},e,{data:t}))}},"soK+":function(e,t,a){e.exports={notice:"notice-module--notice--14xfk"}}}]);
//# sourceMappingURL=component---src-pages-morph-index-js-86f6d06181c02aeb3a58.js.map